# Example configuration.yaml entries for Pill Assistant

# âš ï¸ IMPORTANT: These examples are OPTIONAL and for ADVANCED USERS ONLY!
# 
# Pill Assistant is designed to work entirely through the UI.
# You can add, edit, and delete medications from:
#   1. The Frontend Panel (pill-assistant-panel.html in the sidebar)
#   2. Settings â†’ Devices & Services â†’ Pill Assistant
#
# NO YAML CONFIGURATION IS REQUIRED FOR BASIC OPERATION!
#
# The examples below show how you can OPTIONALLY extend functionality
# with custom helper entities and automations for advanced use cases.

# Optional: Input buttons for quick medication tracking via dashboard cards
# (Not required - you can use the Frontend Panel or Services instead)
input_button:
  took_medication_a:
    name: "Took MedicationA"
    icon: mdi:pill
  
  took_vitamin_d:
    name: "Took Vitamin D"
    icon: mdi:vitamin
  
  refilled_medication_a:
    name: "Refilled MedicationA"
    icon: mdi:package-variant

# Optional: Input booleans for tracking states
# (Not required - for advanced dashboard/automation use only)
input_boolean:
  medication_reminders_enabled:
    name: "Enable Medication Reminders"
    icon: mdi:bell-ring

# Optional: Input datetime for custom scheduling
# (Not required - medications have built-in scheduling through config flow)
input_datetime:
  next_pharmacy_visit:
    name: "Next Pharmacy Visit"
    has_date: true
    has_time: false

# Optional: Template sensors for additional tracking
# (Not required - sensor entities already provide comprehensive attributes)
template:
  - sensor:
      - name: "Medications Due Today"
        state: >
          {% set meds = states.sensor | selectattr('entity_id', 'search', 'sensor\\..*') 
                        | selectattr('attributes.medication_id', 'defined') 
                        | selectattr('state', 'in', ['due', 'overdue', 'scheduled']) | list %}
          {{ meds | count }}
        icon: mdi:calendar-check
      
      - name: "Medications Needing Refill"
        state: >
          {% set meds = states.sensor | selectattr('entity_id', 'search', 'sensor\\..*') 
                        | selectattr('attributes.medication_id', 'defined') 
                        | selectattr('state', 'eq', 'refill_needed') | list %}
          {{ meds | count }}
        icon: mdi:package-variant-closed
      
      - name: "MedicationA Days Until Refill"
        state: >
          {% set remaining = state_attr('sensor.medication_a', 'remaining_amount') | float(0) %}
          {% set times = state_attr('sensor.medication_a', 'schedule')['times'] | list %}
          {% set days = state_attr('sensor.medication_a', 'schedule')['days'] | list %}
          {% set doses_per_day = (times | count * days | count) / 7 %}
          {{ (remaining / doses_per_day) | round(1) if doses_per_day > 0 else 0 }}
        unit_of_measurement: "days"
        icon: mdi:calendar-range

# Optional: Automation examples
# (Not required - these show advanced automation patterns)
automation:
  # Basic notification when medication is due
  - alias: "Notify - Medication Due"
    description: "Send notification when any medication is due"
    trigger:
      - platform: state
        entity_id:
          - sensor.medication_a
          - sensor.vitamin_d
        to: "due"
    condition:
      - condition: state
        entity_id: input_boolean.medication_reminders_enabled
        state: "on"
    action:
      - service: notify.mobile_app
        data:
          title: "ğŸ’Š Medication Reminder"
          message: "Time to take {{ trigger.to_state.name }}"
  
  # Record medication from button press
  - alias: "Record - MedicationA Taken"
    description: "Record MedicationA when button pressed"
    trigger:
      - platform: state
        entity_id: input_button.took_medication_a
    action:
      - service: pill_assistant.take_medication
        data:
          medication_id: "{{ state_attr('sensor.medication_a', 'medication_id') }}"
  
  # Record refill from button press
  - alias: "Record - MedicationA Refilled"
    description: "Record MedicationA refill when button pressed"
    trigger:
      - platform: state
        entity_id: input_button.refilled_medication_a
    action:
      - service: pill_assistant.refill_medication
        data:
          medication_id: "{{ state_attr('sensor.medication_a', 'medication_id') }}"
      - service: notify.mobile_app
        data:
          message: "MedicationA has been refilled to {{ state_attr('sensor.medication_a', 'refill_amount') }} doses"

# Optional: Script examples for common actions
# (Not required - all actions available in Frontend Panel)
script:
  take_all_due_medications:
    alias: "Take All Due Medications"
    description: "Mark all due medications as taken"
    sequence:
      - repeat:
          for_each: >
            {% set ns = namespace(meds=[]) %}
            {% for state in states.sensor %}
              {% if state.attributes.medication_id is defined and state.state == 'due' %}
                {% set ns.meds = ns.meds + [state.entity_id] %}
              {% endif %}
            {% endfor %}
            {{ ns.meds }}
          sequence:
            - service: pill_assistant.take_medication
              data:
                medication_id: "{{ state_attr(repeat.item, 'medication_id') }}"
            - delay:
                seconds: 1
  
  medication_morning_routine:
    alias: "Morning Medication Routine"
    description: "Announce morning medications"
    sequence:
      - service: tts.google_translate_say
        data:
          entity_id: media_player.bedroom_speaker
          message: >
            Good morning! You have {{ states('sensor.medications_due_today') }} 
            medications scheduled for today.
      - delay:
          seconds: 5
      - condition: numeric_state
        entity_id: sensor.medications_needing_refill
        above: 0
      - service: tts.google_translate_say
        data:
          entity_id: media_player.bedroom_speaker
          message: >
            Please note that {{ states('sensor.medications_needing_refill') }} 
            medication(s) need to be refilled soon.

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# REMINDER: All of the above is OPTIONAL!
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 
# You can manage medications entirely through the UI:
#   1. Frontend Panel: Click "Pill Assistant" in your sidebar
#      - Add medications with "Add Medication" button
#      - Edit medications with "Edit" button on each card
#      - Delete medications with "Delete" button on each card
#   
#   2. Settings â†’ Devices & Services â†’ Pill Assistant
#      - Add Integration for new medications
#      - Configure for editing medications
#      - Delete for removing medications
#
# These YAML examples are provided for advanced users who want to create
# custom automations and helper entities beyond the core integration features.
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Note: Replace 'sensor.medication_a' and 'sensor.vitamin_d' with your actual medication sensor entity IDs
# Note: Replace 'mobile_app' with your actual notification service (e.g., 'mobile_app_iphone')
# Note: Replace media player entity IDs with your actual devices
